<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Analex ‚Äî Asistente Virtual</title>
  <!-- Favicon (logo en la pesta√±a del navegador) -->
  <!--<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='logo.ico') }}"> -->
  <!-- Si usas PNG en vez de ICO, descomenta la siguiente l√≠nea -->
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='assets/Analex.jpg') }}">


  <style>
    *{margin:0; padding:0; box-sizing:border-box;}

    body{
      font-family:"Didot","SF Pro Display","Helvetica Neue",serif;
      height:100vh; width:100vw; overflow:hidden;
      display:flex; align-items:center; justify-content:center;
      background:#000; color:#fff;
    }

    /* Fondo cinematogr√°fico inicial */
    #fondo {
      position:fixed; top:0; left:0;
      width:100%; height:100%;
      z-index:-1;
      background: url('/static/assets/cine.jpg') center/cover no-repeat;
      filter:brightness(0.45) contrast(1.15) saturate(0.95);
    }

    /* Video din√°mico */
    #videoFondo {
      position:fixed; top:0; left:0;
      width:100%; height:100%;
      object-fit:cover;
      z-index:-2; display:none;
    }

    /* Overlay */
    #overlay {
      position:relative; text-align:center;
      background: rgba(0,0,0,0.25);
      padding:30px 50px; border-radius:15px;
      backdrop-filter:blur(3px);
      box-shadow:0 10px 30px rgba(0,0,0,0.6);
    }

    #overlay h1{ font-size:3.5rem; font-weight:500; margin-bottom:15px; text-shadow:0 0 15px rgba(0,0,0,0.7);}
    #overlay h2{ font-size:2rem; font-weight:300; margin-bottom:25px; color:#e0e0e0; text-shadow:0 0 10px rgba(0,0,0,0.6);}
    #overlay p{ font-size:1.4rem; color:#ffefb0; margin-top:20px; font-weight:400; text-shadow:0 0 5px rgba(0,0,0,0.5);}

    /* Bot√≥n */
    #hablar{
      padding:14px 36px; font-size:18px; border:none; border-radius:40px; cursor:pointer;
      color:#fff; background:linear-gradient(135deg,#D93434,#7D1515);
      box-shadow:0 6px 30px rgba(0,0,0,0.6); transition:0.3s all; text-transform:uppercase; letter-spacing:1px;
    }
    #hablar:hover{ background:linear-gradient(135deg,#D93434,#7D1515); transform:scale(1.07); box-shadow:0 12px 45px rgba(0,0,0,0.85);}

    /* Intro */
    #intro{
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:#000; display:flex; flex-direction:column; align-items:center; justify-content:center;
      font-size:3rem; letter-spacing:3px; font-weight:500; color:#fff; text-transform:uppercase;
      z-index:1000;
    }
    #intro h1{ font-size:4rem; margin-bottom:15px; }
    #intro p{ font-size:1.4rem; font-weight:300; color:#aaa; }
    #intro span{ font-size:1.1rem; margin-top:10px; color:#ffefb0; }

    audio{ display:none !important; }
  </style>
</head>
<body>

  <!-- Fondo inicial -->
  <div id="fondo"></div>
  <video id="videoFondo" muted loop></video>

  <!-- Intro -->
  <div id="intro">
    <h1>Analex</h1>
    <p>Tu asistente retro-futurista</p>
    <span>De Manosalva Peralta Yojan Alexander</span>
  </div>

  <!-- Overlay principal -->
  <div id="overlay">
    <h1 id="overlayTitulo">Bienvenido a Analex</h1>
    <h2>Habla conmigo y transforma el espacio</h2>
    <button id="hablar">Hablar üéôÔ∏è</button>
    <p id="respuesta">Presiona el bot√≥n y comienza</p>
  </div>

  <audio id="musica"></audio>

  <script>
    const boton=document.getElementById("hablar");
    const respuestaDiv=document.getElementById("respuesta");
    const fondo=document.getElementById("fondo");
    const videoFondo=document.getElementById("videoFondo");
    const musica=document.getElementById("musica");
    const overlayTitulo=document.getElementById("overlayTitulo");
    const intro=document.getElementById("intro");

    // Ocultar intro despu√©s de 3s
    setTimeout(()=>{ intro.style.display="none"; },3000);

    const SpeechRecognition=window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition=new SpeechRecognition();
    recognition.lang="es-ES";

    boton.addEventListener("click",()=>{ recognition.start(); });

    recognition.onresult=function(event){
      const texto=event.results[0][0].transcript;

      fetch("/procesar",{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({texto:texto})
      })
      .then(res=>res.json())
      .then(data=>{
        respuestaDiv.textContent=data.respuesta;

        // Voz
        const voz=new SpeechSynthesisUtterance(data.respuesta);
        voz.lang="es-ES"; voz.rate=0.95; voz.pitch=1.15;
        window.speechSynthesis.speak(voz);

        // Cambiar fondo din√°mico
        if(data.fondo){
          overlayTitulo.style.display="none"; // Oculta t√≠tulo de bienvenida
          if(data.fondo.tipo==="imagen"){
            videoFondo.style.display="none"; videoFondo.pause();
            fondo.style.backgroundImage=`url('${data.fondo.src}')`;
          }
          if(data.fondo.tipo==="video"){
            fondo.style.backgroundImage="none";
            videoFondo.src=data.fondo.src; videoFondo.style.display="block"; videoFondo.play();
          }
        }

        // M√∫sica
        if(data.musica){
          if(data.musica.accion==="play"){ musica.src=data.musica.src; musica.play(); }
          if(data.musica.accion==="pause"){ musica.pause(); }
          if(data.musica.accion==="stop"){ musica.pause(); musica.currentTime=0; }
        }
      });
    }
  </script>
</body>
</html>
